#!/bin/bash
#
# Pre-commit hook to regenerate marketplace.json
#

REPO_ROOT="$(git rev-parse --show-toplevel)"
GENERATE_SCRIPT="$REPO_ROOT/generate-marketplace.sh"

if [[ -x "$GENERATE_SCRIPT" ]]; then
  "$GENERATE_SCRIPT"

  # Stage the updated marketplace.json if it changed
  MARKETPLACE_FILE="$REPO_ROOT/.claude-plugin/marketplace.json"
  if [[ -f "$MARKETPLACE_FILE" ]]; then
    git add "$MARKETPLACE_FILE"
  fi
fi
